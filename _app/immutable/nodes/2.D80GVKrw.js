import{a as w,f as q}from"../chunks/BVTUc5kL.js";import{o as ge}from"../chunks/DjyxYQJ5.js";import{P as xe,v as O,Q as $e,R as ye,S as Se,T as we,U as ke,V as Pe,p as Ue,m as Le,g as r,t as k,W as Q,a as Me,c as n,d as l,o as qe,b as re,X as Ve,u as P,s as oe,r as i,n as Ee,Y as U}from"../chunks/DZ1glEvq.js";import{s as L}from"../chunks/Ff3x3voc.js";import{a as M}from"../chunks/CdoTAns2.js";import{s as ie,a as ne,b as Ie,i as Re,c as se}from"../chunks/Chi0av4Q.js";import{p as Te,e as X,s as le,f as Y,o as j,g as Ae,r as Ce,P as De,c as Ne,b as z}from"../chunks/D3zlxJym.js";import{d as We}from"../chunks/8R4IxEnI.js";import{p as Fe}from"../chunks/BuRonJob.js";import{g as ve}from"../chunks/CEMek83r.js";function ce(a,v,d=!1){if(a.multiple){if(v==null)return;if(!Se(v))return we();for(var c of a.options)c.selected=v.includes($(c));return}for(c of a.options){var f=$(c);if(ke(f,v)){c.selected=!0;return}}(!d||v!==void 0)&&(a.selectedIndex=-1)}function He(a){var v=new MutationObserver(()=>{ce(a,a.__value)});v.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ye(()=>{v.disconnect()})}function de(a,v,d=v){var c=new WeakSet,f=!0;xe(a,"change",p=>{var g=p?"[selected]":":checked",_;if(a.multiple)_=[].map.call(a.querySelectorAll(g),$);else{var b=a.querySelector(g)??a.querySelector("option:not([disabled])");_=b&&$(b)}d(_),O!==null&&c.add(O)}),$e(()=>{var p=v();if(a===document.activeElement){var g=Pe??O;if(c.has(g))return}if(ce(a,p,f),f&&p===void 0){var _=a.querySelector(":checked");_!==null&&(p=$(_),d(p))}a.__value=p,f=!1}),He(a)}function $(a){return"__value"in a?a.__value:a.value}var Oe=q("<option> </option>"),Qe=q("<option> </option>"),Xe=q('<div class="my-1"><a class="text-blue-800 underline"> </a> <a class="text-blue-800 underline">Edit</a> <a class="text-blue-800 underline">Present</a></div>'),Ye=q('<div class="flex flex-row"><div class="self-start p-1"><div><label>Language <select class="border border-black px-0.5 py-1"><option>All</option><!></select></label></div> <div><select class="border border-black px-0.5 py-1"><option> </option><!></select> <button class="border border-black px-1" type="button">Test</button></div> <div><label>Volume <input class="border border-black px-0.5 text-right" type="number"/></label></div> <div><label>Upload <input class="border border-black px-0.5" type="file" accept=".md"/></label></div> <div><button class="border border-black px-2" type="button">New</button></div> <div></div></div> <div class="max-h-screen grow overflow-y-auto"><!></div></div>');function ra(a,v){Ue(v,!0);const d=()=>ne(j,"$optionsStore",f),c=()=>ne(X,"$presentationListStore",f),[f,p]=Ie();let g=P(()=>Fe.url.searchParams.get("p"));var _,b,B,x,V,y,m=Le([async()=>_=await qe(()=>Ae(r(g))),()=>b=re(Ve([])),()=>B=P(()=>[...r(b).reduce((e,t)=>(e.add(t.lang),e),new Set)].sort()),()=>x=re(""),()=>V=P(()=>r(b).filter(e=>!r(x)||e.lang===r(x))),()=>y=P(()=>r(b).find(e=>e.voiceURI===d().voiceUri)),()=>{ge(()=>{const e=()=>{oe(b,speechSynthesis.getVoices(),!0)};return e(),speechSynthesis.addEventListener("voiceschanged",e),()=>{speechSynthesis.removeEventListener("voiceschanged",e)}})}]),E=Ye(),I=n(E),R=n(I),G=n(R),T=l(n(G)),A=n(T);A.value=A.__value="";var ue=l(A);M(ue,[m[2]],void 0,e=>{Y(e,16,()=>r(B),t=>t,(t,o,s,h)=>{var u=Oe(),H=n(u,!0);i(u);var te={};k(()=>{L(H,o),te!==(te=o)&&(u.value=(u.__value=o)??"")}),w(t,u)})}),i(T),i(G),i(R);var C=l(R,2),S=n(C),D=n(S),_e=n(D);i(D);var pe=l(D);M(pe,[m[4]],void 0,e=>{Y(e,17,()=>r(V),t=>t.voiceURI,(t,o)=>{var s=Qe(),h=n(s);i(s);var u={};k(()=>{L(h,`${r(o).name??""} - ${r(o).lang??""}`),u!==(u=r(o).voiceURI)&&(s.value=(s.__value=r(o).voiceURI)??"")}),w(t,s)})}),i(S);var fe=l(S,2);fe.__click=()=>{r(y)&&Te({phrase:`Hello, I am ${r(y).name}`,pitch:1,rate:1,volume:d().volume,voice:r(y)})},i(C);var N=l(C,2),J=n(N),K=l(n(J));Ce(K),i(J),i(N);var W=l(N,2),Z=n(W),be=l(n(Z));be.__change=async e=>{const t=e.currentTarget.files;if(t===null||t.length===0){console.error("no files selected");return}const o=t[0],s=await o.text(),h={id:Date.now().toString(),filename:o.name,name:o.name};ie(X,c().concat([h])),await le(h.id,s),ve(`/?p=${h.id}`)},i(Z),i(W);var F=l(W,2),me=n(F);me.__click=async()=>{const e=Date.now().toString(),t={id:e,filename:`${e}.md`,name:e};ie(X,c().concat([t])),await le(t.id,`# New Presentation

Click on "Edit" to begin

[comment]: #slide-break

## Second Slide

More text goes here`),ve(`/?p=${t.id}`)},i(F);var ee=l(F,2);Y(ee,5,c,e=>e.id,(e,t)=>{var o=Xe(),s=n(o),h=n(s);i(s);var u=l(s,2),H=l(u,2);i(o),k(()=>{z(s,"href",`/?p=${r(t).id}`),L(h,`${r(t).name??""} - ${r(t).id??""}`),z(u,"href",`/edit?p=${r(t).id}`),z(H,"href",`/view?p=${r(t).id}`)}),w(e,o)}),i(ee),i(I);var ae=l(I,2),he=n(ae);M(he,[m[0]],void 0,e=>{var t=o=>{M(o,[m[0]],void 0,s=>{De(s,{get presentationMd(){return r(_).content}})}),Ee()};Re(e,o=>{r(g)&&r(_).content.length>0&&o(t)})}),i(ae),i(E),k(()=>L(_e,`Choose a voice (${r(V).length??""})`),void 0,void 0,[m[4]]),Q([m[4]],()=>{de(T,()=>r(x),e=>oe(x,e))}),Q([m[5]],()=>{de(S,()=>d().voiceUri,e=>se(j,U(d).voiceUri=e,U(d)))}),Q([m[5]],()=>{Ne(K,()=>d().volume,e=>se(j,U(d).volume=e,U(d)))}),w(a,E),Me(),p()}We(["click","change"]);export{ra as component};
